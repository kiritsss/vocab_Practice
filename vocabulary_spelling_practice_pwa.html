<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#667eea">
    <meta name="description" content="Interactive vocabulary spelling practice with offline support">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Vocab Practice">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" sizes="192x192" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect fill='%23667eea' width='100' height='100'/><text y='75' font-size='70' fill='white' text-anchor='middle' x='50'>üìö</text></svg>">
    
    <title>Vocabulary Spelling Practice - PWA</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        /* PWA Install Banner */
        .install-banner {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px 25px;
            border-radius: 50px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            display: none;
            align-items: center;
            gap: 15px;
            z-index: 10000;
            animation: slideUp 0.5s;
        }

        .install-banner.show {
            display: flex;
        }

        @keyframes slideUp {
            from { bottom: -100px; }
            to { bottom: 20px; }
        }

        .install-banner button {
            background: white;
            color: #667eea;
            border: none;
            padding: 10px 20px;
            border-radius: 25px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }

        .install-banner button:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(255,255,255,0.3);
        }

        .install-banner .close-btn {
            background: transparent;
            color: white;
            padding: 5px 10px;
            font-size: 1.2em;
        }

        /* Offline Indicator */
        .offline-indicator {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #ff9800;
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            box-shadow: 0 5px 15px rgba(255, 152, 0, 0.4);
            display: none;
            align-items: center;
            gap: 10px;
            z-index: 9999;
            font-weight: 600;
        }

        .offline-indicator.show {
            display: flex;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
            position: relative;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }

        .pwa-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(255,255,255,0.2);
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.8em;
            font-weight: bold;
            backdrop-filter: blur(10px);
        }

        .score-board {
            display: flex;
            justify-content: space-around;
            background: rgba(255,255,255,0.2);
            padding: 15px;
            border-radius: 10px;
            margin-top: 20px;
        }

        .score-item {
            text-align: center;
        }

        .score-item .label {
            font-size: 0.9em;
            opacity: 0.9;
        }

        .score-item .value {
            font-size: 2em;
            font-weight: bold;
            margin-top: 5px;
        }

        .trophy {
            font-size: 1.5em;
            margin-bottom: 5px;
        }

        .nav-buttons {
            display: flex;
            gap: 10px;
            padding: 20px;
            background: #f8f9fa;
            flex-wrap: wrap;
            justify-content: center;
        }

        .nav-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s;
            font-weight: 600;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }

        .nav-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.6);
        }

        .nav-btn.active {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            box-shadow: 0 4px 15px rgba(245, 87, 108, 0.4);
        }

        .exercise-container {
            padding: 30px;
            display: none;
        }

        .exercise-container.active {
            display: block;
            animation: fadeIn 0.5s;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .exercise-title {
            color: #667eea;
            font-size: 1.8em;
            margin-bottom: 10px;
        }

        .exercise-instructions {
            background: #e3f2fd;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 25px;
            border-left: 4px solid #667eea;
        }

        .question {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 15px;
            border: 2px solid transparent;
            transition: all 0.3s;
        }

        .question.correct {
            border-color: #4caf50;
            background: #e8f5e9;
        }

        .question.incorrect {
            border-color: #f44336;
            background: #ffebee;
        }

        .question-text {
            font-size: 1.1em;
            margin-bottom: 10px;
            font-weight: 500;
        }

        .input-group {
            display: flex;
            gap: 10px;
            align-items: center;
            flex-wrap: wrap;
        }

        input[type="text"] {
            flex: 1;
            min-width: 200px;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1em;
            transition: all 0.3s;
        }

        input[type="text"]:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.95em;
            transition: all 0.3s;
            font-weight: 600;
        }

        .btn-check {
            background: #4caf50;
            color: white;
        }

        .btn-check:hover {
            background: #45a049;
            transform: scale(1.05);
        }

        .btn-hint {
            background: #ff9800;
            color: white;
        }

        .btn-hint:hover {
            background: #f57c00;
            transform: scale(1.05);
        }

        .btn-hint:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        .btn-show {
            background: #2196f3;
            color: white;
        }

        .btn-show:hover {
            background: #1976d2;
        }

        .feedback {
            margin-top: 10px;
            padding: 10px;
            border-radius: 8px;
            font-weight: 500;
        }

        .feedback.correct {
            background: #e8f5e9;
            color: #2e7d32;
        }

        .feedback.incorrect {
            background: #ffebee;
            color: #c62828;
        }

        .hint {
            margin-top: 10px;
            padding: 10px;
            background: #fff3cd;
            border-left: 4px solid #ff9800;
            border-radius: 8px;
        }

        .check-all-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: 600;
            margin: 20px auto;
            display: block;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }

        .check-all-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.6);
        }

        .results-summary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            margin-top: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .results-summary h3 {
            font-size: 2em;
            margin-bottom: 20px;
        }

        .results-score {
            font-size: 3em;
            font-weight: bold;
            margin: 20px 0;
        }

        .results-message {
            font-size: 1.2em;
            margin-top: 15px;
        }

        .practice-again-btn {
            background: white;
            color: #667eea;
            border: none;
            padding: 15px 40px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: 600;
            margin-top: 20px;
            transition: all 0.3s;
        }

        .practice-again-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 20px rgba(255,255,255,0.3);
        }

        .achievement {
            position: fixed;
            top: 20px;
            right: 20px;
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            transform: translateX(400px);
            transition: transform 0.5s;
            z-index: 1000;
            max-width: 300px;
        }

        .achievement.show {
            transform: translateX(0);
        }

        .achievement h4 {
            margin-bottom: 10px;
            font-size: 1.2em;
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .tab-btn {
            flex: 1;
            min-width: 150px;
            padding: 12px;
            background: #f0f0f0;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
        }

        .tab-btn.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.5s;
        }

        .history-item {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 10px;
            border-left: 4px solid #667eea;
        }

        .history-date {
            color: #666;
            font-size: 0.9em;
            margin-bottom: 5px;
        }

        .history-score {
            font-size: 1.2em;
            font-weight: bold;
            color: #667eea;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
        }

        .stat-card h4 {
            font-size: 2.5em;
            margin: 10px 0;
        }

        .stat-card p {
            opacity: 0.9;
        }

        /* Mini Games Styles */
        .game-menu {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            padding: 20px;
        }

        .game-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .game-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.5);
        }

        .game-card h3 {
            font-size: 1.5em;
            margin-bottom: 10px;
        }

        .game-stats {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid rgba(255,255,255,0.3);
            font-size: 0.9em;
        }

        .race-input {
            width: 100%;
            padding: 15px;
            font-size: 1.2em;
            border: 3px solid #667eea;
            border-radius: 10px;
            margin: 20px 0;
            text-align: center;
        }

        .timer {
            font-size: 3em;
            color: #667eea;
            text-align: center;
            margin: 20px 0;
            font-weight: bold;
        }

        .word-display {
            font-size: 2em;
            text-align: center;
            padding: 30px;
            background: #f8f9fa;
            border-radius: 15px;
            margin: 20px 0;
            font-weight: bold;
            color: #667eea;
        }

        .score-display {
            font-size: 1.5em;
            text-align: center;
            margin: 20px 0;
            color: #667eea;
            font-weight: bold;
        }

        .memory-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            max-width: 600px;
            margin: 20px auto;
        }

        .memory-card {
            aspect-ratio: 1;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            font-size: 1.5em;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
        }

        .memory-card:hover {
            transform: scale(1.05);
        }

        .memory-card.flipped {
            background: white;
            color: #667eea;
        }

        .memory-card.matched {
            background: #4caf50;
            cursor: default;
        }

        .hangman-drawing {
            font-size: 5em;
            text-align: center;
            margin: 20px 0;
        }

        .keyboard {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 10px;
            max-width: 600px;
            margin: 20px auto;
        }

        .letter-button {
            padding: 15px;
            font-size: 1.2em;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
        }

        .letter-button:hover:not(:disabled) {
            background: #764ba2;
            transform: scale(1.1);
        }

        .letter-button:disabled {
            background: #ccc;
            cursor: not-allowed;
            opacity: 0.5;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.8em;
            }

            .nav-btn {
                font-size: 0.9em;
                padding: 10px 20px;
            }

            .exercise-title {
                font-size: 1.4em;
            }

            .memory-grid {
                grid-template-columns: repeat(4, 1fr);
                gap: 10px;
            }

            .keyboard {
                grid-template-columns: repeat(7, 1fr);
                gap: 5px;
            }

            .letter-button {
                padding: 10px;
                font-size: 1em;
            }
        }
    </style>
</head>
<body>
    <!-- Offline Indicator -->
    <div class="offline-indicator" id="offlineIndicator">
        <span>üìµ</span>
        <span>Offline Mode - Data Saved Locally</span>
    </div>

    <!-- PWA Install Banner -->
    <div class="install-banner" id="installBanner">
        <span style="font-size: 1.5em;">üì±</span>
        <span>Install this app for offline practice!</span>
        <button id="installBtn">Install</button>
        <button class="close-btn" id="closeBanner">√ó</button>
    </div>

    <div class="container">
        <div class="header">
            <div class="pwa-badge">‚ö° PWA Enabled</div>
            <h1>üìö Vocabulary Spelling Practice</h1>
            <p>Master your English vocabulary with interactive exercises</p>
            
            <div class="score-board">
                <div class="score-item">
                    <div class="trophy">üèÜ</div>
                    <div class="label">Total Points</div>
                    <div class="value" id="totalScore">0</div>
                </div>
                <div class="score-item">
                    <div class="trophy">üìà</div>
                    <div class="label">Exercises</div>
                    <div class="value" id="exerciseCount">0</div>
                </div>
                <div class="score-item">
                    <div class="trophy">üî•</div>
                    <div class="label">Streak</div>
                    <div class="value" id="streakCount">0</div>
                </div>
            </div>
        </div>

        <div class="nav-buttons">
            <button class="nav-btn active" onclick="showExercise(0)">üåü Exercise 1</button>
            <button class="nav-btn" onclick="showExercise(1)">üéØ Exercise 2</button>
            <button class="nav-btn" onclick="showExercise(2)">üíé Exercise 3</button>
            <button class="nav-btn" onclick="showExercise(3)">üöÄ Exercise 4</button>
            <button class="nav-btn" onclick="showExercise(4)">‚ö° Exercise 5</button>
            <button class="nav-btn" onclick="showExercise(5)">üåà Exercise 6</button>
            <button class="nav-btn" onclick="showExercise(6)">üéÆ Mini Games</button>
            <button class="nav-btn" onclick="showExercise(7)">üìä Progress</button>
        </div>

        <!-- Exercise 1: Word Completion -->
        <div class="exercise-container active" id="exercise0">
            <h2 class="exercise-title">üåü Exercise 1: Complete the Words</h2>
            <div class="exercise-instructions">
                <strong>Instructions:</strong> Complete each word by filling in the missing letters. Use the hints if you need help!
            </div>
            <div id="exercise0-questions"></div>
            <button class="check-all-btn" onclick="checkAllAnswers(0)">‚úÖ Check All Answers</button>
        </div>

        <!-- Exercise 2: Fill in the Blanks -->
        <div class="exercise-container" id="exercise1">
            <h2 class="exercise-title">üéØ Exercise 2: Fill in the Blanks</h2>
            <div class="exercise-instructions">
                <strong>Instructions:</strong> Complete the sentences by spelling the words correctly. Pay attention to the context!
            </div>
            <div id="exercise1-questions"></div>
            <button class="check-all-btn" onclick="checkAllAnswers(1)">‚úÖ Check All Answers</button>
        </div>

        <!-- Exercise 3: Spelling Challenge -->
        <div class="exercise-container" id="exercise2">
            <h2 class="exercise-title">üíé Exercise 3: Spelling Challenge</h2>
            <div class="exercise-instructions">
                <strong>Instructions:</strong> Spell the words correctly based on their definitions.
            </div>
            <div id="exercise2-questions"></div>
            <button class="check-all-btn" onclick="checkAllAnswers(2)">‚úÖ Check All Answers</button>
        </div>

        <!-- Exercise 4: Advanced Vocabulary -->
        <div class="exercise-container" id="exercise3">
            <h2 class="exercise-title">üöÄ Exercise 4: Advanced Vocabulary</h2>
            <div class="exercise-instructions">
                <strong>Instructions:</strong> Complete these advanced vocabulary words. Challenge yourself!
            </div>
            <div id="exercise3-questions"></div>
            <button class="check-all-btn" onclick="checkAllAnswers(3)">‚úÖ Check All Answers</button>
        </div>

        <!-- Exercise 5: Common Mistakes -->
        <div class="exercise-container" id="exercise4">
            <h2 class="exercise-title">‚ö° Exercise 5: Common Spelling Mistakes</h2>
            <div class="exercise-instructions">
                <strong>Instructions:</strong> Practice words that are commonly misspelled.
            </div>
            <div id="exercise4-questions"></div>
            <button class="check-all-btn" onclick="checkAllAnswers(4)">‚úÖ Check All Answers</button>
        </div>

        <!-- Exercise 6: Mixed Practice -->
        <div class="exercise-container" id="exercise5">
            <h2 class="exercise-title">üåà Exercise 6: Mixed Practice</h2>
            <div class="exercise-instructions">
                <strong>Instructions:</strong> A mix of all difficulty levels. Test your overall spelling skills!
            </div>
            <div id="exercise5-questions"></div>
            <button class="check-all-btn" onclick="checkAllAnswers(5)">‚úÖ Check All Answers</button>
        </div>

        <!-- Mini Games Section -->
        <div class="exercise-container" id="exercise6">
            <h2 class="exercise-title">üéÆ Vocabulary Mini Games</h2>
            <div class="tabs">
                <button class="tab-btn active" onclick="switchTab('games')">üéØ Games</button>
                <button class="tab-btn" onclick="switchTab('stats')">üìä Statistics</button>
            </div>
            
            <div id="games-tab" class="tab-content active">
                <div class="game-menu">
                    <div class="game-card" onclick="startGame('race')">
                        <h3>‚è±Ô∏è Word Race</h3>
                        <p>Type words as fast as you can!</p>
                        <div class="game-stats">
                            <div>High Score: <span id="raceHighScore">0</span></div>
                            <div>Games Played: <span id="racePlayed">0</span></div>
                        </div>
                    </div>
                    
                    <div class="game-card" onclick="startGame('memory')">
                        <h3>üß† Memory Match</h3>
                        <p>Match words with definitions!</p>
                        <div class="game-stats">
                            <div>Best Time: <span id="memoryBestTime">--</span></div>
                            <div>Games Played: <span id="memoryPlayed">0</span></div>
                        </div>
                    </div>
                    
                    <div class="game-card" onclick="startGame('hangman')">
                        <h3>üé≠ Hangman</h3>
                        <p>Guess the word letter by letter!</p>
                        <div class="game-stats">
                            <div>High Score: <span id="hangmanHighScore">0</span></div>
                            <div>Games Played: <span id="hangmanPlayed">0</span></div>
                        </div>
                    </div>
                    
                    <div class="game-card" onclick="startGame('builder')">
                        <h3>üî§ Word Builder</h3>
                        <p>Unscramble the letters!</p>
                        <div class="game-stats">
                            <div>High Score: <span id="builderHighScore">0</span></div>
                            <div>Games Played: <span id="builderPlayed">0</span></div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div id="stats-tab" class="tab-content">
                <div id="miniGameStats"></div>
            </div>
            
            <div id="gameArea" style="display: none;"></div>
        </div>

        <!-- Progress Section -->
        <div class="exercise-container" id="exercise7">
            <h2 class="exercise-title">üìä Your Progress</h2>
            
            <div class="tabs">
                <button class="tab-btn active" onclick="switchProgressTab('stats')">üìà Statistics</button>
                <button class="tab-btn" onclick="switchProgressTab('history')">üìú History</button>
            </div>

            <div id="stats-progress" class="tab-content active">
                <div class="stats-grid" id="statsGrid"></div>
            </div>

            <div id="history-progress" class="tab-content">
                <div id="historyList"></div>
            </div>

            <button class="check-all-btn" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);" onclick="resetAllProgress()">
                üóëÔ∏è Reset All Data
            </button>
        </div>
    </div>

    <div class="achievement" id="achievement"></div>

    <script>
        // Service Worker Registration
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('service-worker.js')
                    .then(registration => {
                        console.log('‚úÖ PWA: Service Worker registered successfully!');
                        console.log('üì± Offline mode is now available');
                    })
                    .catch(error => {
                        console.log('‚ùå Service Worker registration failed:', error);
                    });
            });
        }

        // PWA Install Banner
        let deferredPrompt;
        const installBanner = document.getElementById('installBanner');
        const installBtn = document.getElementById('installBtn');
        const closeBanner = document.getElementById('closeBanner');

        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            installBanner.classList.add('show');
        });

        installBtn.addEventListener('click', async () => {
            if (!deferredPrompt) return;
            
            deferredPrompt.prompt();
            const { outcome } = await deferredPrompt.userChoice;
            
            if (outcome === 'accepted') {
                console.log('User accepted the install prompt');
            }
            
            deferredPrompt = null;
            installBanner.classList.remove('show');
        });

        closeBanner.addEventListener('click', () => {
            installBanner.classList.remove('show');
        });

        // Offline/Online Detection
        const offlineIndicator = document.getElementById('offlineIndicator');

        function updateOnlineStatus() {
            if (!navigator.onLine) {
                offlineIndicator.classList.add('show');
            } else {
                offlineIndicator.classList.remove('show');
            }
        }

        window.addEventListener('online', updateOnlineStatus);
        window.addEventListener('offline', updateOnlineStatus);
        updateOnlineStatus();

        // Vocabulary data
        const exercises = [
            // Exercise 1: Basic completion
            [
                { word: "beautiful", partial: "beau__ful", hint: "Very attractive or pleasing" },
                { word: "important", partial: "imp__tant", hint: "Of great significance" },
                { word: "necessary", partial: "nece__ary", hint: "Required or needed" },
                { word: "different", partial: "dif__rent", hint: "Not the same" },
                { word: "interesting", partial: "inter__ting", hint: "Arousing curiosity" },
                { word: "difficult", partial: "dif__cult", hint: "Hard to do" },
                { word: "possible", partial: "pos__ble", hint: "Able to be done" },
                { word: "education", partial: "edu__tion", hint: "Process of learning" },
                { word: "environment", partial: "envir__ment", hint: "Natural surroundings" },
                { word: "government", partial: "gov__nment", hint: "System of ruling" }
            ],
            // Exercise 2: Fill in blanks
            [
                { word: "receive", sentence: "I will ____ the package tomorrow.", hint: "To get or accept something" },
                { word: "believe", sentence: "I ____ in your abilities.", hint: "To accept as true" },
                { word: "achieve", sentence: "You can ____ your goals.", hint: "To successfully complete" },
                { word: "separate", sentence: "Please ____ the papers by color.", hint: "To divide or set apart" },
                { word: "definitely", sentence: "I will ____ attend the meeting.", hint: "Without doubt" },
                { word: "immediately", sentence: "Please respond ____.", hint: "Right away" },
                { word: "restaurant", sentence: "Let's meet at the ____.", hint: "Place to eat" },
                { word: "accommodate", sentence: "This hotel can ____ 200 guests.", hint: "To provide space for" },
                { word: "embarrass", sentence: "Don't ____ me in public.", hint: "To cause to feel awkward" },
                { word: "recommend", sentence: "Can you ____ a good book?", hint: "To suggest as suitable" }
            ],
            // Exercise 3: Spelling from definition
            [
                { word: "knowledge", hint: "Information and skills acquired through experience or education" },
                { word: "schedule", hint: "A plan for carrying out a process or procedure" },
                { word: "conscience", hint: "An inner feeling acting as a guide to right or wrong" },
                { word: "maintenance", hint: "The process of maintaining or preserving something" },
                { word: "phenomenon", hint: "A remarkable or impressive event" },
                { word: "committee", hint: "A group appointed for a specific function" },
                { word: "occurrence", hint: "An incident or event" },
                { word: "privilege", hint: "A special right or advantage" },
                { word: "calendar", hint: "A chart showing days, weeks, and months" },
                { word: "guarantee", hint: "A formal promise or assurance" }
            ],
            // Exercise 4: Advanced words
            [
                { word: "miscellaneous", partial: "mis__llaneous", hint: "Various items of different types" },
                { word: "questionnaire", partial: "ques__nnaire", hint: "A set of printed questions" },
                { word: "pronunciation", partial: "pronun__ation", hint: "The way a word is spoken" },
                { word: "bureaucracy", partial: "bur__ucracy", hint: "System of government by officials" },
                { word: "entrepreneurship", partial: "entre__neurship", hint: "Activity of setting up businesses" },
                { word: "pharmaceutical", partial: "pharma__utical", hint: "Relating to medicinal drugs" },
                { word: "psychology", partial: "psy__ology", hint: "Study of the mind and behavior" },
                { word: "archaeology", partial: "arch__ology", hint: "Study of human history through excavation" },
                { word: "characteristic", partial: "charac__ristic", hint: "A distinguishing feature" },
                { word: "Mediterranean", partial: "Medi__rranean", hint: "A sea between Europe and Africa" }
            ],
            // Exercise 5: Common mistakes
            [
                { word: "accommodation", hint: "A place to live or stay" },
                { word: "occurrence", hint: "An incident or event" },
                { word: "embarrassment", hint: "A feeling of self-consciousness" },
                { word: "commitment", hint: "State of being dedicated to a cause" },
                { word: "maintenance", hint: "The process of maintaining" },
                { word: "necessary", hint: "Required; needed" },
                { word: "separate", hint: "To divide or set apart" },
                { word: "definitely", hint: "Without doubt" },
                { word: "government", hint: "System of ruling a country" },
                { word: "environment", hint: "Natural world or surroundings" }
            ],
            // Exercise 6: Mixed difficulty
            [
                { word: "beautiful", sentence: "The sunset was absolutely ____.", hint: "Very attractive" },
                { word: "restaurant", partial: "res__aurant", hint: "Place to eat" },
                { word: "psychology", hint: "Study of the mind and behavior" },
                { word: "receive", sentence: "Did you ____ my email?", hint: "To get" },
                { word: "Mediterranean", hint: "Sea between Europe and Africa" },
                { word: "achieve", partial: "ach__ve", hint: "To accomplish" },
                { word: "questionnaire", hint: "A set of questions for survey" },
                { word: "immediately", sentence: "Please come here ____.", hint: "Right away" },
                { word: "privilege", partial: "priv__lege", hint: "A special right" },
                { word: "embarrass", hint: "To cause to feel awkward or ashamed" }
            ]
        ];

        // Score tracking
        let scoreData = {
            totalScore: 0,
            exercisesCompleted: 0,
            streak: 0,
            lastDate: null,
            exerciseScores: {},
            history: [],
            miniGames: {
                wordRace: { highScore: 0, gamesPlayed: 0 },
                memoryMatch: { bestTime: Infinity, gamesPlayed: 0 },
                hangman: { highScore: 0, gamesPlayed: 0 },
                wordBuilder: { highScore: 0, gamesPlayed: 0 }
            }
        };

        // Load saved score
        function loadScore() {
            const saved = localStorage.getItem('vocabularyScore');
            if (saved) {
                scoreData = JSON.parse(saved);
                updateScoreDisplay();
                updateStreak();
            }
        }

        function saveScore() {
            localStorage.setItem('vocabularyScore', JSON.stringify(scoreData));
        }

        function updateScoreDisplay() {
            document.getElementById('totalScore').textContent = scoreData.totalScore;
            document.getElementById('exerciseCount').textContent = scoreData.exercisesCompleted;
            document.getElementById('streakCount').textContent = scoreData.streak;
        }

        function updateStreak() {
            const today = new Date().toDateString();
            if (scoreData.lastDate !== today) {
                const yesterday = new Date(Date.now() - 86400000).toDateString();
                if (scoreData.lastDate === yesterday) {
                    scoreData.streak++;
                } else if (scoreData.lastDate !== null) {
                    scoreData.streak = 1;
                }
                scoreData.lastDate = today;
                saveScore();
            }
        }

        function addToHistory(exerciseNum, score, total) {
            scoreData.history.unshift({
                date: new Date().toISOString(),
                exercise: exerciseNum + 1,
                score: score,
                total: total,
                percentage: Math.round((score / total) * 100)
            });
            if (scoreData.history.length > 50) {
                scoreData.history.pop();
            }
            saveScore();
        }

        function showAchievement(message) {
            const achievement = document.getElementById('achievement');
            achievement.innerHTML = `<h4>üèÜ Achievement!</h4><p>${message}</p>`;
            achievement.classList.add('show');
            setTimeout(() => {
                achievement.classList.remove('show');
            }, 3000);
        }

        // Initialize exercises
        function initExercise(exerciseNum) {
            const container = document.getElementById(`exercise${exerciseNum}-questions`);
            const exerciseData = exercises[exerciseNum];
            
            container.innerHTML = '';
            
            exerciseData.forEach((item, index) => {
                const questionDiv = document.createElement('div');
                questionDiv.className = 'question';
                questionDiv.id = `question${exerciseNum}-${index}`;
                
                let questionHTML = '<div class="question-text">';
                
                if (item.partial) {
                    questionHTML += `Complete the word: <strong>${item.partial}</strong>`;
                } else if (item.sentence) {
                    questionHTML += item.sentence;
                } else {
                    questionHTML += `Spell the word: <em>${item.hint}</em>`;
                }
                
                questionHTML += '</div>';
                questionHTML += '<div class="input-group">';
                questionHTML += `<input type="text" id="answer${exerciseNum}-${index}" placeholder="Type your answer..." autocomplete="off" spellcheck="false">`;
                questionHTML += `<button class="btn btn-check" onclick="checkAnswer(${exerciseNum}, ${index})">Check</button>`;
                questionHTML += `<button class="btn btn-hint" onclick="showHint(${exerciseNum}, ${index})">üí° Hint</button>`;
                questionHTML += `<button class="btn btn-show" onclick="showAnswer(${exerciseNum}, ${index})">üëÅ Show</button>`;
                questionHTML += '</div>';
                questionHTML += `<div id="feedback${exerciseNum}-${index}" class="feedback" style="display: none;"></div>`;
                questionHTML += `<div id="hint${exerciseNum}-${index}" class="hint" style="display: none;">${item.hint}</div>`;
                
                questionDiv.innerHTML = questionHTML;
                container.appendChild(questionDiv);
            });
        }

        function checkAnswer(exerciseNum, questionNum) {
            const input = document.getElementById(`answer${exerciseNum}-${questionNum}`);
            const feedback = document.getElementById(`feedback${exerciseNum}-${questionNum}`);
            const question = document.getElementById(`question${exerciseNum}-${questionNum}`);
            const correctAnswer = exercises[exerciseNum][questionNum].word.toLowerCase();
            const userAnswer = input.value.trim().toLowerCase();
            
            if (userAnswer === correctAnswer) {
                feedback.textContent = '‚úÖ Correct! Well done!';
                feedback.className = 'feedback correct';
                question.classList.add('correct');
                question.classList.remove('incorrect');
                input.disabled = true;
                
                if (!scoreData.exerciseScores[`${exerciseNum}-${questionNum}`]) {
                    scoreData.totalScore += 10;
                    scoreData.exerciseScores[`${exerciseNum}-${questionNum}`] = true;
                    updateScoreDisplay();
                    saveScore();
                }
            } else if (userAnswer === '') {
                feedback.textContent = '‚ö†Ô∏è Please enter an answer.';
                feedback.className = 'feedback';
            } else {
                feedback.textContent = `‚ùå Not quite. Try again!`;
                feedback.className = 'feedback incorrect';
                question.classList.add('incorrect');
                question.classList.remove('correct');
            }
            
            feedback.style.display = 'block';
        }

        function showHint(exerciseNum, questionNum) {
            const hint = document.getElementById(`hint${exerciseNum}-${questionNum}`);
            hint.style.display = hint.style.display === 'none' ? 'block' : 'none';
        }

        function showAnswer(exerciseNum, questionNum) {
            if (confirm('Are you sure? This will show the answer and you won\'t earn points.')) {
                const input = document.getElementById(`answer${exerciseNum}-${questionNum}`);
                const feedback = document.getElementById(`feedback${exerciseNum}-${questionNum}`);
                const correctAnswer = exercises[exerciseNum][questionNum].word;
                
                input.value = correctAnswer;
                input.disabled = true;
                feedback.textContent = `‚ÑπÔ∏è The answer is: ${correctAnswer}`;
                feedback.className = 'feedback';
                feedback.style.display = 'block';
            }
        }

        function checkAllAnswers(exerciseNum) {
            const exerciseData = exercises[exerciseNum];
            let correct = 0;
            let total = exerciseData.length;
            
            exerciseData.forEach((item, index) => {
                const input = document.getElementById(`answer${exerciseNum}-${index}`);
                const userAnswer = input.value.trim().toLowerCase();
                const correctAnswer = item.word.toLowerCase();
                
                if (userAnswer === correctAnswer) {
                    correct++;
                }
                
                checkAnswer(exerciseNum, index);
            });
            
            // Show results
            const percentage = Math.round((correct / total) * 100);
            let message = '';
            let emoji = '';
            
            if (percentage === 100) {
                message = 'Perfect! Outstanding work! üåü';
                emoji = 'üèÜ';
                showAchievement(`Perfect score on Exercise ${exerciseNum + 1}!`);
            } else if (percentage >= 80) {
                message = 'Excellent! Great job! üéâ';
                emoji = '‚≠ê';
            } else if (percentage >= 60) {
                message = 'Good effort! Keep practicing! üëç';
                emoji = 'üìö';
            } else {
                message = 'Keep trying! Practice makes perfect! üí™';
                emoji = 'üìñ';
            }
            
            scoreData.exercisesCompleted++;
            updateScoreDisplay();
            addToHistory(exerciseNum, correct, total);
            saveScore();
            
            const container = document.getElementById(`exercise${exerciseNum}`);
            const resultsDiv = document.createElement('div');
            resultsDiv.className = 'results-summary';
            resultsDiv.innerHTML = `
                <h3>${emoji} Results</h3>
                <div class="results-score">${correct} / ${total}</div>
                <div class="results-message">${message}</div>
                <div style="margin-top: 20px;">Accuracy: ${percentage}%</div>
                <button class="practice-again-btn" onclick="resetExercise(${exerciseNum})">üîÑ Practice Again</button>
            `;
            container.appendChild(resultsDiv);
            resultsDiv.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }

        function resetExercise(exerciseNum) {
            const container = document.getElementById(`exercise${exerciseNum}`);
            const results = container.querySelector('.results-summary');
            if (results) {
                results.remove();
            }
            
            // Reset all inputs and feedback
            exercises[exerciseNum].forEach((item, index) => {
                const input = document.getElementById(`answer${exerciseNum}-${index}`);
                const feedback = document.getElementById(`feedback${exerciseNum}-${index}`);
                const hint = document.getElementById(`hint${exerciseNum}-${index}`);
                const question = document.getElementById(`question${exerciseNum}-${index}`);
                
                input.value = '';
                input.disabled = false;
                feedback.style.display = 'none';
                hint.style.display = 'none';
                question.classList.remove('correct', 'incorrect');
            });
        }

        function showExercise(num) {
            // Hide all exercises
            document.querySelectorAll('.exercise-container').forEach(ex => {
                ex.classList.remove('active');
            });
            
            // Update navigation buttons
            document.querySelectorAll('.nav-btn').forEach((btn, index) => {
                if (index === num) {
                    btn.classList.add('active');
                } else {
                    btn.classList.remove('active');
                }
            });
            
            // Show selected exercise
            document.getElementById(`exercise${num}`).classList.add('active');
            
            // Update progress if showing progress tab
            if (num === 7) {
                updateProgressDisplay();
            }
            
            // Update mini game stats
            if (num === 6) {
                updateMiniGameStats();
            }
        }

        function updateProgressDisplay() {
            // Update statistics
            const statsGrid = document.getElementById('statsGrid');
            statsGrid.innerHTML = `
                <div class="stat-card">
                    <p>üèÜ Total Points</p>
                    <h4>${scoreData.totalScore}</h4>
                </div>
                <div class="stat-card">
                    <p>üìù Exercises Completed</p>
                    <h4>${scoreData.exercisesCompleted}</h4>
                </div>
                <div class="stat-card">
                    <p>üî• Current Streak</p>
                    <h4>${scoreData.streak} days</h4>
                </div>
                <div class="stat-card">
                    <p>üìä Total Sessions</p>
                    <h4>${scoreData.history.length}</h4>
                </div>
            `;
            
            // Update history
            const historyList = document.getElementById('historyList');
            if (scoreData.history.length === 0) {
                historyList.innerHTML = '<p style="text-align: center; color: #666; padding: 40px;">No history yet. Complete an exercise to see your progress!</p>';
            } else {
                historyList.innerHTML = scoreData.history.map(entry => {
                    const date = new Date(entry.date);
                    return `
                        <div class="history-item">
                            <div class="history-date">${date.toLocaleDateString()} ${date.toLocaleTimeString()}</div>
                            <div>Exercise ${entry.exercise}</div>
                            <div class="history-score">${entry.score}/${entry.total} (${entry.percentage}%)</div>
                        </div>
                    `;
                }).join('');
            }
        }

        function switchProgressTab(tab) {
            document.querySelectorAll('#exercise7 .tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelectorAll('#exercise7 .tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            event.target.classList.add('active');
            document.getElementById(`${tab}-progress`).classList.add('active');
        }

        // Mini Games
        let currentGame = null;
        let gameState = {};

        function switchTab(tab) {
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            event.target.classList.add('active');
            document.getElementById(`${tab}-tab`).classList.add('active');
        }

        function startGame(gameType) {
            currentGame = gameType;
            const gameArea = document.getElementById('gameArea');
            gameArea.style.display = 'block';
            document.querySelector('.game-menu').style.display = 'none';
            
            switch(gameType) {
                case 'race':
                    initWordRace(gameArea);
                    break;
                case 'memory':
                    initMemoryMatch(gameArea);
                    break;
                case 'hangman':
                    initHangman(gameArea);
                    break;
                case 'builder':
                    initWordBuilder(gameArea);
                    break;
            }
        }

        function endGame() {
            document.getElementById('gameArea').style.display = 'none';
            document.querySelector('.game-menu').style.display = 'grid';
            currentGame = null;
            updateMiniGameStats();
        }

        // Word Race Game
        function initWordRace(container) {
            const words = [...exercises[1], ...exercises[2]].sort(() => Math.random() - 0.5).slice(0, 20);
            gameState = {
                words: words,
                currentIndex: 0,
                score: 0,
                timeLeft: 60,
                timer: null
            };
            
            container.innerHTML = `
                <h3 style="text-align: center; color: #667eea;">‚è±Ô∏è Word Race</h3>
                <div class="timer" id="timer">60</div>
                <div class="score-display">Score: <span id="raceScore">0</span> / 20</div>
                <div class="word-display" id="raceWord">${words[0].hint}</div>
                <input type="text" class="race-input" id="raceInput" placeholder="Type the word..." autocomplete="off">
                <button class="check-all-btn" onclick="endGame()">üèÅ Quit</button>
            `;
            
            const input = document.getElementById('raceInput');
            input.focus();
            input.addEventListener('input', checkRaceAnswer);
            
            gameState.timer = setInterval(() => {
                gameState.timeLeft--;
                document.getElementById('timer').textContent = gameState.timeLeft;
                
                if (gameState.timeLeft <= 0) {
                    clearInterval(gameState.timer);
                    endWordRace();
                }
            }, 1000);
            
            scoreData.miniGames.wordRace.gamesPlayed++;
            saveScore();
        }

        function checkRaceAnswer() {
            const input = document.getElementById('raceInput');
            const answer = input.value.trim().toLowerCase();
            const correct = gameState.words[gameState.currentIndex].word.toLowerCase();
            
            if (answer === correct) {
                gameState.score++;
                gameState.currentIndex++;
                document.getElementById('raceScore').textContent = gameState.score;
                
                if (gameState.currentIndex >= gameState.words.length) {
                    clearInterval(gameState.timer);
                    endWordRace();
                    return;
                }
                
                document.getElementById('raceWord').textContent = gameState.words[gameState.currentIndex].hint;
                input.value = '';
                
                // Brief green flash
                input.style.borderColor = '#4caf50';
                setTimeout(() => {
                    input.style.borderColor = '#667eea';
                }, 200);
            }
        }

        function endWordRace() {
            if (gameState.score > scoreData.miniGames.wordRace.highScore) {
                scoreData.miniGames.wordRace.highScore = gameState.score;
                showAchievement(`üèÜ New Word Race record: ${gameState.score} words!`);
            }
            saveScore();
            alert(`Time's up! You typed ${gameState.score} words correctly!`);
            endGame();
        }

        // Memory Match Game
        function initMemoryMatch(container) {
            const pairs = exercises[2].slice(0, 8);
            const cards = [];
            pairs.forEach(item => {
                cards.push({ type: 'word', value: item.word, id: item.word });
                cards.push({ type: 'hint', value: item.hint, id: item.word });
            });
            cards.sort(() => Math.random() - 0.5);
            
            gameState = {
                cards: cards,
                flipped: [],
                matched: [],
                startTime: Date.now(),
                checking: false
            };
            
            container.innerHTML = `
                <h3 style="text-align: center; color: #667eea;">üß† Memory Match</h3>
                <div class="score-display">Matches: <span id="matchCount">0</span> / 8</div>
                <div class="memory-grid" id="memoryGrid"></div>
                <button class="check-all-btn" onclick="endGame()">üèÅ Quit</button>
            `;
            
            const grid = document.getElementById('memoryGrid');
            cards.forEach((card, index) => {
                const btn = document.createElement('button');
                btn.className = 'memory-card';
                btn.textContent = '?';
                btn.onclick = () => flipCard(index);
                grid.appendChild(btn);
            });
            
            scoreData.miniGames.memoryMatch.gamesPlayed++;
            saveScore();
        }

        function flipCard(index) {
            if (gameState.checking || gameState.flipped.includes(index) || gameState.matched.includes(index)) {
                return;
            }
            
            const cards = document.querySelectorAll('.memory-card');
            const card = gameState.cards[index];
            
            cards[index].textContent = card.type === 'word' ? card.value : card.value.slice(0, 20) + '...';
            cards[index].classList.add('flipped');
            gameState.flipped.push(index);
            
            if (gameState.flipped.length === 2) {
                gameState.checking = true;
                setTimeout(checkMatch, 1000);
            }
        }

        function checkMatch() {
            const [index1, index2] = gameState.flipped;
            const card1 = gameState.cards[index1];
            const card2 = gameState.cards[index2];
            
            if (card1.id === card2.id) {
                // Match!
                gameState.matched.push(index1, index2);
                document.querySelectorAll('.memory-card')[index1].classList.add('matched');
                document.querySelectorAll('.memory-card')[index2].classList.add('matched');
                document.getElementById('matchCount').textContent = gameState.matched.length / 2;
                
                if (gameState.matched.length === gameState.cards.length) {
                    const time = Math.round((Date.now() - gameState.startTime) / 1000);
                    if (time < scoreData.miniGames.memoryMatch.bestTime) {
                        scoreData.miniGames.memoryMatch.bestTime = time;
                        showAchievement(`üß† New Memory Match record: ${time} seconds!`);
                    }
                    saveScore();
                    setTimeout(() => {
                        alert(`Congratulations! You completed it in ${time} seconds!`);
                        endGame();
                    }, 500);
                }
            } else {
                // No match
                document.querySelectorAll('.memory-card')[index1].classList.remove('flipped');
                document.querySelectorAll('.memory-card')[index2].classList.remove('flipped');
                document.querySelectorAll('.memory-card')[index1].textContent = '?';
                document.querySelectorAll('.memory-card')[index2].textContent = '?';
            }
            
            gameState.flipped = [];
            gameState.checking = false;
        }

        // Hangman Game
        function initHangman(container) {
            const allWords = [...exercises[1], ...exercises[2], ...exercises[4], ...exercises[5]];
            const randomWord = allWords[Math.floor(Math.random() * allWords.length)];
            
            gameState = {
                word: randomWord.word.toLowerCase(),
                hint: randomWord.hint,
                guessed: [],
                wrongGuesses: 0,
                maxWrong: 6,
                score: 100
            };
            
            container.innerHTML = `
                <h3 style="text-align: center; color: #667eea;">üé≠ Hangman</h3>
                <div class="score-display">Score: <span id="hangmanScore">100</span></div>
                <div class="hangman-drawing" id="hangmanDrawing">${getHangmanDrawing(0)}</div>
                <div class="word-display" id="hangmanWord">${getDisplayWord()}</div>
                <div style="text-align: center; margin: 20px; font-size: 1.1em; color: #666;">
                    <strong>Hint:</strong> ${gameState.hint}
                </div>
                <div class="keyboard" id="hangmanKeyboard"></div>
                <button class="check-all-btn" onclick="endGame()">üèÅ Quit</button>
            `;
            
            // Create keyboard
            const keyboard = document.getElementById('hangmanKeyboard');
            'abcdefghijklmnopqrstuvwxyz'.split('').forEach(letter => {
                const btn = document.createElement('button');
                btn.className = 'letter-button';
                btn.textContent = letter.toUpperCase();
                btn.onclick = () => guessLetter(letter);
                keyboard.appendChild(btn);
            });
            
            scoreData.miniGames.hangman.gamesPlayed++;
            saveScore();
        }

        function getHangmanDrawing(wrong) {
            const drawings = ['üòä', 'üòê', 'üòü', 'üò®', 'üò±', 'üòµ', 'üíÄ'];
            return drawings[wrong];
        }

        function getDisplayWord() {
            return gameState.word.split('').map(letter => 
                gameState.guessed.includes(letter) ? letter.toUpperCase() : '_'
            ).join(' ');
        }

        function guessLetter(letter) {
            if (gameState.guessed.includes(letter)) return;
            
            gameState.guessed.push(letter);
            
            // Disable button
            const buttons = document.querySelectorAll('.letter-button');
            buttons.forEach(btn => {
                if (btn.textContent.toLowerCase() === letter) {
                    btn.disabled = true;
                }
            });
            
            if (gameState.word.includes(letter)) {
                // Correct guess
                document.getElementById('hangmanWord').textContent = getDisplayWord();
                
                // Check if won
                if (!getDisplayWord().includes('_')) {
                    if (gameState.score > scoreData.miniGames.hangman.highScore) {
                        scoreData.miniGames.hangman.highScore = gameState.score;
                        showAchievement(`üé≠ New Hangman record: ${gameState.score} points!`);
                    }
                    saveScore();
                    setTimeout(() => {
                        alert(`You won! Score: ${gameState.score}\nWord: ${gameState.word.toUpperCase()}`);
                        endGame();
                    }, 300);
                }
            } else {
                // Wrong guess
                gameState.wrongGuesses++;
                gameState.score -= 10;
                document.getElementById('hangmanScore').textContent = gameState.score;
                document.getElementById('hangmanDrawing').textContent = getHangmanDrawing(gameState.wrongGuesses);
                
                if (gameState.wrongGuesses >= gameState.maxWrong) {
                    setTimeout(() => {
                        alert(`Game Over! The word was: ${gameState.word.toUpperCase()}`);
                        endGame();
                    }, 300);
                }
            }
        }

        // Word Builder Game
        function initWordBuilder(container) {
            const allWords = [...exercises[2]].sort(() => Math.random() - 0.5).slice(0, 10);
            
            gameState = {
                words: allWords,
                currentIndex: 0,
                score: 0,
                scrambled: ''
            };
            
            scrambleCurrentWord();
            
            container.innerHTML = `
                <h3 style="text-align: center; color: #667eea;">üî§ Word Builder</h3>
                <div class="score-display">Score: <span id="builderScore">0</span> / 10</div>
                <div style="text-align: center; margin: 20px; font-size: 1.1em; color: #666;">
                    <strong>Hint:</strong> <span id="builderHint">${gameState.words[0].hint}</span>
                </div>
                <div class="word-display" id="builderScrambled">${gameState.scrambled}</div>
                <input type="text" class="race-input" id="builderInput" placeholder="Unscramble the word..." autocomplete="off">
                <button class="check-all-btn" onclick="checkBuilderAnswer()">Check Answer</button>
                <button class="check-all-btn" onclick="endGame()" style="background: #f44336;">üèÅ Quit</button>
            `;
            
            document.getElementById('builderInput').addEventListener('keypress', (e) => {
                if (e.key === 'Enter') checkBuilderAnswer();
            });
            
            scoreData.miniGames.wordBuilder.gamesPlayed++;
            saveScore();
        }

        function scrambleCurrentWord() {
            const word = gameState.words[gameState.currentIndex].word;
            gameState.scrambled = word.split('').sort(() => Math.random() - 0.5).join('').toUpperCase();
        }

        function checkBuilderAnswer() {
            const input = document.getElementById('builderInput');
            const answer = input.value.trim().toLowerCase();
            const correct = gameState.words[gameState.currentIndex].word.toLowerCase();
            
            if (answer === correct) {
                gameState.score++;
                gameState.currentIndex++;
                document.getElementById('builderScore').textContent = gameState.score;
                
                if (gameState.currentIndex >= gameState.words.length) {
                    // Game complete
                    if (gameState.score > scoreData.miniGames.wordBuilder.highScore) {
                        scoreData.miniGames.wordBuilder.highScore = gameState.score;
                        showAchievement(`üî§ New Word Builder record: ${gameState.score}/10!`);
                    }
                    saveScore();
                    alert(`Completed! Perfect score: ${gameState.score}/10!`);
                    endGame();
                } else {
                    // Next word
                    scrambleCurrentWord();
                    document.getElementById('builderScrambled').textContent = gameState.scrambled;
                    document.getElementById('builderHint').textContent = gameState.words[gameState.currentIndex].hint;
                    input.value = '';
                    
                    // Brief green flash
                    input.style.borderColor = '#4caf50';
                    setTimeout(() => {
                        input.style.borderColor = '#667eea';
                    }, 200);
                }
            } else {
                // Wrong answer
                input.style.borderColor = '#f44336';
                setTimeout(() => {
                    input.style.borderColor = '#667eea';
                }, 500);
            }
        }

        function updateMiniGameStats() {
            document.getElementById('raceHighScore').textContent = scoreData.miniGames.wordRace.highScore;
            document.getElementById('racePlayed').textContent = scoreData.miniGames.wordRace.gamesPlayed;
            
            const memoryTime = scoreData.miniGames.memoryMatch.bestTime;
            document.getElementById('memoryBestTime').textContent = memoryTime === Infinity ? '--' : memoryTime + 's';
            document.getElementById('memoryPlayed').textContent = scoreData.miniGames.memoryMatch.gamesPlayed;
            
            document.getElementById('hangmanHighScore').textContent = scoreData.miniGames.hangman.highScore;
            document.getElementById('hangmanPlayed').textContent = scoreData.miniGames.hangman.gamesPlayed;
            
            document.getElementById('builderHighScore').textContent = scoreData.miniGames.wordBuilder.highScore;
            document.getElementById('builderPlayed').textContent = scoreData.miniGames.wordBuilder.gamesPlayed;
        }

        function resetAllProgress() {
            if (confirm('‚ö†Ô∏è WARNING: This will DELETE ALL your data including history, high scores, and sessions. This CANNOT be undone! Are you absolutely sure?')) {
                const doubleCheck = confirm('Are you REALLY sure? Type "yes" in the next prompt to confirm.');
                if (doubleCheck) {
                    const finalConfirm = prompt('Type "DELETE" to permanently erase all data:');
                    if (finalConfirm === 'DELETE') {
                        localStorage.removeItem('vocabularyScore');
                        alert('‚úÖ All data has been deleted. The app will now reload.');
                        location.reload();
                    }
                }
            }
        }

        // Enter key functionality
        document.addEventListener('keypress', function(e) {
            if (e.key === 'Enter' && e.target.tagName === 'INPUT') {
                const inputId = e.target.id;
                const match = inputId.match(/answer(\d+)-(\d+)/);
                if (match) {
                    checkAnswer(parseInt(match[1]), parseInt(match[2]));
                }
            }
        });

        // Initialize
        window.addEventListener('load', () => {
            loadScore();
            for (let i = 0; i < 6; i++) {
                initExercise(i);
            }
            console.log('‚úÖ Vocabulary Practice PWA loaded successfully!');
            console.log('üì± You can install this app for offline use');
        });
    </script>
</body>
</html>